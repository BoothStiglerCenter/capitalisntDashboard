geom_line(aes(x=date, y=cumulative_downloads, color=label_w_group_id, alpha=daily_alpha, group=episode_title), size=1.25)+
geom_label_repel(data = chars_downloads_data %>%
arrange(release_date) %>%
group_by(episode_title) %>%
mutate(first_date = ifelse(date == release_date+1, 1,0),
group_id = cur_group_id()) %>%
ungroup() %>%
filter(first_date == 1),
nudge_y=-500,
aes(x=date, y=cumulative_downloads, color=episode_title, label=group_id))+
annotate(geom = "rect", xmin = as.Date("2021-04-01"), xmax=as.Date("2021-04-30"), ymin=0, ymax=Inf, fill="red", alpha=0.2)+
annotate(geom="text", x= as.Date("2021-04-30"), y=17000, label="Economist Media Group", color="red")+
annotate(geom = "rect", xmin = as.Date("2021-06-01"), xmax=as.Date("2021-06-15"), ymin=0, ymax=Inf, fill="yellow", alpha=0.2)+
annotate(geom="text", x= as.Date("2021-06-01"), y=18000, label="Vox Media")+
scale_y_continuous(labels=scales::comma)+
# scale_color_discrete(guide="none")+
scale_alpha_continuous(guide="none")+
ylab("Cumulative Downloads")+
xlab("Date")+
ggtitle("Daily Episode-Cumulative Downloads")+
theme_minimal()+
theme(
# legend.position='bottom',
legend.position="none"
)
ggplot(chars_downloads_data %>%
mutate(daily_alpha = 1 + log(1/days_since_release)) %>%
arrange(release_date) %>%
group_by(episode_title) %>%
mutate(first_date = ifelse(date == release_date, 1, 0),
group_id = cur_group_id(),
label_w_group_id = paste(group_id, episode_title, sep='. ')))+
geom_line(aes(x=date, y=cumulative_downloads, color=label_w_group_id, alpha=daily_alpha, group=episode_title), size=1.25)+
geom_label_repel(data = chars_downloads_data %>%
arrange(release_date) %>%
group_by(episode_title) %>%
mutate(first_date = ifelse(date == release_date+1, 1,0),
group_id = cur_group_id()) %>%
ungroup() %>%
filter(first_date == 1),
nudge_y=-500,
aes(x=date, y=cumulative_downloads, color=label_w_group_id, label=group_id))+
annotate(geom = "rect", xmin = as.Date("2021-04-01"), xmax=as.Date("2021-04-30"), ymin=0, ymax=Inf, fill="red", alpha=0.2)+
annotate(geom="text", x= as.Date("2021-04-30"), y=17000, label="Economist Media Group", color="red")+
annotate(geom = "rect", xmin = as.Date("2021-06-01"), xmax=as.Date("2021-06-15"), ymin=0, ymax=Inf, fill="yellow", alpha=0.2)+
annotate(geom="text", x= as.Date("2021-06-01"), y=18000, label="Vox Media")+
scale_y_continuous(labels=scales::comma)+
# scale_color_discrete(guide="none")+
scale_alpha_continuous(guide="none")+
ylab("Cumulative Downloads")+
xlab("Date")+
ggtitle("Daily Episode-Cumulative Downloads")+
theme_minimal()+
theme(
# legend.position='bottom',
legend.position="none"
)
ggplot(chars_downloads_data %>%
mutate(daily_alpha = 1 + log(1/days_since_release)) %>%
arrange(release_date) %>%
group_by(episode_title) %>%
mutate(first_date = ifelse(date == release_date, 1, 0),
group_id = cur_group_id(),
label_w_group_id = paste(group_id, episode_title, sep='. ')))+
geom_line(aes(x=date, y=cumulative_downloads, color=label_w_group_id, alpha=daily_alpha, group=episode_title), size=1.25)+
geom_label_repel(data = chars_downloads_data %>%
arrange(release_date) %>%
group_by(episode_title) %>%
mutate(first_date = ifelse(date == release_date+1, 1,0),
group_id = cur_group_id(),
label_w_group_id = paste(group_id, episode_title, sep='. ')) %>%
ungroup() %>%
filter(first_date == 1),
nudge_y=-500,
aes(x=date, y=cumulative_downloads, color=label_w_group_id, label=group_id))+
annotate(geom = "rect", xmin = as.Date("2021-04-01"), xmax=as.Date("2021-04-30"), ymin=0, ymax=Inf, fill="red", alpha=0.2)+
annotate(geom="text", x= as.Date("2021-04-30"), y=17000, label="Economist Media Group", color="red")+
annotate(geom = "rect", xmin = as.Date("2021-06-01"), xmax=as.Date("2021-06-15"), ymin=0, ymax=Inf, fill="yellow", alpha=0.2)+
annotate(geom="text", x= as.Date("2021-06-01"), y=18000, label="Vox Media")+
scale_y_continuous(labels=scales::comma)+
# scale_color_discrete(guide="none")+
scale_alpha_continuous(guide="none")+
ylab("Cumulative Downloads")+
xlab("Date")+
ggtitle("Daily Episode-Cumulative Downloads")+
theme_minimal()+
theme(
# legend.position='bottom',
legend.position="none"
)
ggplot(chars_downloads_data %>%
mutate(daily_alpha = 1 + log(1/days_since_release)) %>%
arrange(release_date) %>%
group_by(episode_title) %>%
mutate(first_date = ifelse(date == release_date, 1, 0),
group_id = cur_group_id(),
label_w_group_id = paste(group_id, episode_title, sep='. ')))+
geom_line(aes(x=date, y=cumulative_downloads, color=label_w_group_id, alpha=daily_alpha, group=episode_title), size=1.25)+
# geom_label_repel(data = chars_downloads_data %>%
#                   arrange(release_date) %>%
#                   group_by(episode_title) %>%
#                   mutate(first_date = ifelse(date == release_date+1, 1,0),
#                          group_id = cur_group_id(),
#                          label_w_group_id = paste(group_id, episode_title, sep='. ')) %>%
#                   ungroup() %>%
#                   filter(first_date == 1),
#                 nudge_y=-500,
#                 aes(x=date, y=cumulative_downloads, color=label_w_group_id, label=group_id))+
annotate(geom = "rect", xmin = as.Date("2021-04-01"), xmax=as.Date("2021-04-30"), ymin=0, ymax=Inf, fill="red", alpha=0.2)+
annotate(geom="text", x= as.Date("2021-04-30"), y=17000, label="Economist Media Group", color="red")+
annotate(geom = "rect", xmin = as.Date("2021-06-01"), xmax=as.Date("2021-06-15"), ymin=0, ymax=Inf, fill="yellow", alpha=0.2)+
annotate(geom="text", x= as.Date("2021-06-01"), y=18000, label="Vox Media")+
scale_y_continuous(labels=scales::comma)+
scale_color_discrete(guide="none")+
scale_alpha_continuous(guide="none")+
ylab("Cumulative Downloads")+
xlab("Date")+
ggtitle("Daily Episode-Cumulative Downloads")+
theme_minimal()+
theme(
# legend.position='bottom',
# legend.position="none"
)
ggplot(chars_downloads_data %>%
mutate(daily_alpha = 1 + log(1/days_since_release)) %>%
arrange(release_date) %>%
group_by(episode_title) %>%
mutate(first_date = ifelse(date == release_date, 1, 0),
group_id = cur_group_id(),
label_w_group_id = paste(group_id, episode_title, sep='. ')))+
geom_line(aes(x=date, y=cumulative_downloads, color=label_w_group_id, alpha=daily_alpha, group=episode_title), size=1.25)+
# geom_label_repel(data = chars_downloads_data %>%
#                   arrange(release_date) %>%
#                   group_by(episode_title) %>%
#                   mutate(first_date = ifelse(date == release_date+1, 1,0),
#                          group_id = cur_group_id(),
#                          label_w_group_id = paste(group_id, episode_title, sep='. ')) %>%
#                   ungroup() %>%
#                   filter(first_date == 1),
#                 nudge_y=-500,
#                 aes(x=date, y=cumulative_downloads, color=label_w_group_id, label=group_id))+
annotate(geom = "rect", xmin = as.Date("2021-04-01"), xmax=as.Date("2021-04-30"), ymin=0, ymax=Inf, fill="red", alpha=0.2)+
annotate(geom="text", x= as.Date("2021-04-30"), y=17000, label="Economist Media Group", color="red")+
annotate(geom = "rect", xmin = as.Date("2021-06-01"), xmax=as.Date("2021-06-15"), ymin=0, ymax=Inf, fill="yellow", alpha=0.2)+
annotate(geom="text", x= as.Date("2021-06-01"), y=18000, label="Vox Media")+
scale_y_continuous(labels=scales::comma)+
# scale_color_discrete(guide="none")+
scale_alpha_continuous(guide="none")+
ylab("Cumulative Downloads")+
xlab("Date")+
ggtitle("Daily Episode-Cumulative Downloads")+
theme_minimal()+
theme(
# legend.position='bottom',
# legend.position="none"
)
ggplot(chars_downloads_data %>%
mutate(daily_alpha = 1 + log(1/days_since_release)) %>%
arrange(release_date) %>%
group_by(episode_title) %>%
mutate(first_date = ifelse(date == release_date, 1, 0),
group_id = cur_group_id(),
label_w_group_id = paste(group_id, episode_title, sep='. ')))+
geom_line(aes(x=date, y=cumulative_downloads, color=label_w_group_id, alpha=daily_alpha, group=episode_title), size=1.25)+
# geom_label_repel(data = chars_downloads_data %>%
#                   arrange(release_date) %>%
#                   group_by(episode_title) %>%
#                   mutate(first_date = ifelse(date == release_date+1, 1,0),
#                          group_id = cur_group_id(),
#                          label_w_group_id = paste(group_id, episode_title, sep='. ')) %>%
#                   ungroup() %>%
#                   filter(first_date == 1),
#                 nudge_y=-500,
#                 aes(x=date, y=cumulative_downloads, color=label_w_group_id, label=group_id))+
annotate(geom = "rect", xmin = as.Date("2021-04-01"), xmax=as.Date("2021-04-30"), ymin=0, ymax=Inf, fill="red", alpha=0.2)+
annotate(geom="text", x= as.Date("2021-04-30"), y=17000, label="Economist Media Group", color="red")+
annotate(geom = "rect", xmin = as.Date("2021-06-01"), xmax=as.Date("2021-06-15"), ymin=0, ymax=Inf, fill="yellow", alpha=0.2)+
annotate(geom="text", x= as.Date("2021-06-01"), y=18000, label="Vox Media")+
scale_y_continuous(labels=scales::comma)+
# scale_color_discrete(guide="none")+
scale_alpha_continuous(guide="none")+
ylab("Cumulative Downloads")+
xlab("Date")+
ggtitle("Daily Episode-Cumulative Downloads")+
theme_minimal()+
theme(
# legend.position='bottom',
# legend.position="none"
)
?scale_color_discrete
ggplot(chars_downloads_data %>%
mutate(daily_alpha = 1 + log(1/days_since_release)) %>%
arrange(release_date) %>%
group_by(episode_title) %>%
mutate(first_date = ifelse(date == release_date, 1, 0),
group_id = cur_group_id(),
label_w_group_id = paste(group_id, episode_title, sep='. ')))+
geom_line(aes(x=date, y=cumulative_downloads, color=label_w_group_id, alpha=daily_alpha, group=episode_title), size=1.25)+
# geom_label_repel(data = chars_downloads_data %>%
#                   arrange(release_date) %>%
#                   group_by(episode_title) %>%
#                   mutate(first_date = ifelse(date == release_date+1, 1,0),
#                          group_id = cur_group_id(),
#                          label_w_group_id = paste(group_id, episode_title, sep='. ')) %>%
#                   ungroup() %>%
#                   filter(first_date == 1),
#                 nudge_y=-500,
#                 aes(x=date, y=cumulative_downloads, color=label_w_group_id, label=group_id))+
annotate(geom = "rect", xmin = as.Date("2021-04-01"), xmax=as.Date("2021-04-30"), ymin=0, ymax=Inf, fill="red", alpha=0.2)+
annotate(geom="text", x= as.Date("2021-04-30"), y=17000, label="Economist Media Group", color="red")+
annotate(geom = "rect", xmin = as.Date("2021-06-01"), xmax=as.Date("2021-06-15"), ymin=0, ymax=Inf, fill="yellow", alpha=0.2)+
annotate(geom="text", x= as.Date("2021-06-01"), y=18000, label="Vox Media")+
scale_y_continuous(labels=scales::comma)+
scale_color_discrete(breaks = chars_downloads_data %>%
arrange(release_date) %>%
select(episode_title))+
# scale_color_discrete(guide="none")+
scale_alpha_continuous(guide="none")+
ylab("Cumulative Downloads")+
xlab("Date")+
ggtitle("Daily Episode-Cumulative Downloads")+
theme_minimal()+
theme(
# legend.position='bottom',
# legend.position="none"
)
ggplot(chars_downloads_data %>%
mutate(daily_alpha = 1 + log(1/days_since_release)) %>%
arrange(release_date) %>%
group_by(episode_title) %>%
mutate(first_date = ifelse(date == release_date, 1, 0),
group_id = cur_group_id(),
label_w_group_id = paste(group_id, episode_title, sep='. ')))+
geom_line(aes(x=date, y=cumulative_downloads, color=label_w_group_id, alpha=daily_alpha, group=episode_title), size=1.25)+
# geom_label_repel(data = chars_downloads_data %>%
#                   arrange(release_date) %>%
#                   group_by(episode_title) %>%
#                   mutate(first_date = ifelse(date == release_date+1, 1,0),
#                          group_id = cur_group_id(),
#                          label_w_group_id = paste(group_id, episode_title, sep='. ')) %>%
#                   ungroup() %>%
#                   filter(first_date == 1),
#                 nudge_y=-500,
#                 aes(x=date, y=cumulative_downloads, color=label_w_group_id, label=group_id))+
annotate(geom = "rect", xmin = as.Date("2021-04-01"), xmax=as.Date("2021-04-30"), ymin=0, ymax=Inf, fill="red", alpha=0.2)+
annotate(geom="text", x= as.Date("2021-04-30"), y=17000, label="Economist Media Group", color="red")+
annotate(geom = "rect", xmin = as.Date("2021-06-01"), xmax=as.Date("2021-06-15"), ymin=0, ymax=Inf, fill="yellow", alpha=0.2)+
annotate(geom="text", x= as.Date("2021-06-01"), y=18000, label="Vox Media")+
scale_y_continuous(labels=scales::comma)+
scale_color_discrete(breaks = chars_downloads_data %>%
arrange(release_date) %>%
select(episode_title) %>%
unique())+
# scale_color_discrete(guide="none")+
scale_alpha_continuous(guide="none")+
ylab("Cumulative Downloads")+
xlab("Date")+
ggtitle("Daily Episode-Cumulative Downloads")+
theme_minimal()+
theme(
# legend.position='bottom',
# legend.position="none"
)
ggplot(chars_downloads_data %>%
mutate(daily_alpha = 1 + log(1/days_since_release)) %>%
arrange(release_date) %>%
group_by(episode_title) %>%
mutate(first_date = ifelse(date == release_date, 1, 0),
group_id = cur_group_id(),
label_w_group_id = paste(group_id, episode_title, sep='. ')))+
geom_line(aes(x=date, y=cumulative_downloads, color=label_w_group_id, alpha=daily_alpha, group=episode_title), size=1.25)+
# geom_label_repel(data = chars_downloads_data %>%
#                   arrange(release_date) %>%
#                   group_by(episode_title) %>%
#                   mutate(first_date = ifelse(date == release_date+1, 1,0),
#                          group_id = cur_group_id(),
#                          label_w_group_id = paste(group_id, episode_title, sep='. ')) %>%
#                   ungroup() %>%
#                   filter(first_date == 1),
#                 nudge_y=-500,
#                 aes(x=date, y=cumulative_downloads, color=label_w_group_id, label=group_id))+
annotate(geom = "rect", xmin = as.Date("2021-04-01"), xmax=as.Date("2021-04-30"), ymin=0, ymax=Inf, fill="red", alpha=0.2)+
annotate(geom="text", x= as.Date("2021-04-30"), y=17000, label="Economist Media Group", color="red")+
annotate(geom = "rect", xmin = as.Date("2021-06-01"), xmax=as.Date("2021-06-15"), ymin=0, ymax=Inf, fill="yellow", alpha=0.2)+
annotate(geom="text", x= as.Date("2021-06-01"), y=18000, label="Vox Media")+
scale_y_continuous(labels=scales::comma)+
scale_color_discrete(labels = chars_downloads_data %>%
arrange(release_date) %>%
select(episode_title) %>%
unique())+
# scale_color_discrete(guide="none")+
scale_alpha_continuous(guide="none")+
ylab("Cumulative Downloads")+
xlab("Date")+
ggtitle("Daily Episode-Cumulative Downloads")+
theme_minimal()+
theme(
# legend.position='bottom',
# legend.position="none"
)
ggplot(chars_downloads_data %>%
mutate(daily_alpha = 1 + log(1/days_since_release)) %>%
arrange(release_date) %>%
group_by(episode_title) %>%
mutate(first_date = ifelse(date == release_date, 1, 0),
group_id = cur_group_id(),
label_w_group_id = paste(group_id, episode_title, sep='. ')))+
geom_line(aes(x=date, y=cumulative_downloads, color=label_w_group_id, alpha=daily_alpha, group=episode_title), size=1.25)+
# geom_label_repel(data = chars_downloads_data %>%
#                   arrange(release_date) %>%
#                   group_by(episode_title) %>%
#                   mutate(first_date = ifelse(date == release_date+1, 1,0),
#                          group_id = cur_group_id(),
#                          label_w_group_id = paste(group_id, episode_title, sep='. ')) %>%
#                   ungroup() %>%
#                   filter(first_date == 1),
#                 nudge_y=-500,
#                 aes(x=date, y=cumulative_downloads, color=label_w_group_id, label=group_id))+
annotate(geom = "rect", xmin = as.Date("2021-04-01"), xmax=as.Date("2021-04-30"), ymin=0, ymax=Inf, fill="red", alpha=0.2)+
annotate(geom="text", x= as.Date("2021-04-30"), y=17000, label="Economist Media Group", color="red")+
annotate(geom = "rect", xmin = as.Date("2021-06-01"), xmax=as.Date("2021-06-15"), ymin=0, ymax=Inf, fill="yellow", alpha=0.2)+
annotate(geom="text", x= as.Date("2021-06-01"), y=18000, label="Vox Media")+
scale_y_continuous(labels=scales::comma)+
scale_color_discrete(labels = unique(labels_w_group_id))+
# scale_color_discrete(guide="none")+
scale_alpha_continuous(guide="none")+
ylab("Cumulative Downloads")+
xlab("Date")+
ggtitle("Daily Episode-Cumulative Downloads")+
theme_minimal()+
theme(
# legend.position='bottom',
# legend.position="none"
)
ggplot(chars_downloads_data %>%
mutate(daily_alpha = 1 + log(1/days_since_release)) %>%
arrange(release_date) %>%
group_by(episode_title) %>%
mutate(first_date = ifelse(date == release_date, 1, 0),
group_id = cur_group_id(),
label_w_group_id = paste(group_id, episode_title, sep='. ')))+
geom_line(aes(x=date, y=cumulative_downloads, color=label_w_group_id, alpha=daily_alpha, group=episode_title), size=1.25)+
# geom_label_repel(data = chars_downloads_data %>%
#                   arrange(release_date) %>%
#                   group_by(episode_title) %>%
#                   mutate(first_date = ifelse(date == release_date+1, 1,0),
#                          group_id = cur_group_id(),
#                          label_w_group_id = paste(group_id, episode_title, sep='. ')) %>%
#                   ungroup() %>%
#                   filter(first_date == 1),
#                 nudge_y=-500,
#                 aes(x=date, y=cumulative_downloads, color=label_w_group_id, label=group_id))+
annotate(geom = "rect", xmin = as.Date("2021-04-01"), xmax=as.Date("2021-04-30"), ymin=0, ymax=Inf, fill="red", alpha=0.2)+
annotate(geom="text", x= as.Date("2021-04-30"), y=17000, label="Economist Media Group", color="red")+
annotate(geom = "rect", xmin = as.Date("2021-06-01"), xmax=as.Date("2021-06-15"), ymin=0, ymax=Inf, fill="yellow", alpha=0.2)+
annotate(geom="text", x= as.Date("2021-06-01"), y=18000, label="Vox Media")+
scale_y_continuous(labels=scales::comma)+
scale_color_discrete()+
# scale_color_discrete(guide="none")+
scale_alpha_continuous(guide="none")+
ylab("Cumulative Downloads")+
xlab("Date")+
ggtitle("Daily Episode-Cumulative Downloads")+
theme_minimal()+
theme(
# legend.position='bottom',
# legend.position="none"
)
ggplot(chars_downloads_data %>%
mutate(daily_alpha = 1 + log(1/days_since_release)) %>%
arrange(release_date) %>%
group_by(episode_title) %>%
mutate(first_date = ifelse(date == release_date, 1, 0),
group_id = cur_group_id(),
label_w_group_id = paste(group_id, episode_title, sep='. ')) %>%
view())+
geom_line(aes(x=date, y=cumulative_downloads, color=label_w_group_id, alpha=daily_alpha, group=episode_title), size=1.25)+
# geom_label_repel(data = chars_downloads_data %>%
#                   arrange(release_date) %>%
#                   group_by(episode_title) %>%
#                   mutate(first_date = ifelse(date == release_date+1, 1,0),
#                          group_id = cur_group_id(),
#                          label_w_group_id = paste(group_id, episode_title, sep='. ')) %>%
#                   ungroup() %>%
#                   filter(first_date == 1),
#                 nudge_y=-500,
#                 aes(x=date, y=cumulative_downloads, color=label_w_group_id, label=group_id))+
annotate(geom = "rect", xmin = as.Date("2021-04-01"), xmax=as.Date("2021-04-30"), ymin=0, ymax=Inf, fill="red", alpha=0.2)+
annotate(geom="text", x= as.Date("2021-04-30"), y=17000, label="Economist Media Group", color="red")+
annotate(geom = "rect", xmin = as.Date("2021-06-01"), xmax=as.Date("2021-06-15"), ymin=0, ymax=Inf, fill="yellow", alpha=0.2)+
annotate(geom="text", x= as.Date("2021-06-01"), y=18000, label="Vox Media")+
scale_y_continuous(labels=scales::comma)+
scale_color_discrete()+
# scale_color_discrete(guide="none")+
scale_alpha_continuous(guide="none")+
ylab("Cumulative Downloads")+
xlab("Date")+
ggtitle("Daily Episode-Cumulative Downloads")+
theme_minimal()+
theme(
# legend.position='bottom',
# legend.position="none"
)
chars_downloads_data %>% group_by(episode_title) %>% arrange(release_date) %>% view()
chars_downloads_data %>% group_by(episode_title) %>% arrange(release_date) %>% mutate(group_id = cur_group_id()) %>% view()
?cur_group_id()
chars_downloads_data %>% group_by(release_date) %>% mutate(group_id = cur_group_id()) %>% view()
ggplot(chars_downloads_data %>%
mutate(daily_alpha = 1 + log(1/days_since_release)) %>%
arrange(release_date) %>%
group_by(release_date) %>%
mutate(first_date = ifelse(date == release_date, 1, 0),
group_id = cur_group_id(),
label_w_group_id = paste(group_id, episode_title, sep='. ')) %>%
view())+
geom_line(aes(x=date, y=cumulative_downloads, color=label_w_group_id, alpha=daily_alpha, group=episode_title), size=1.25)+
# geom_label_repel(data = chars_downloads_data %>%
#                   arrange(release_date) %>%
#                   group_by(episode_title) %>%
#                   mutate(first_date = ifelse(date == release_date+1, 1,0),
#                          group_id = cur_group_id(),
#                          label_w_group_id = paste(group_id, episode_title, sep='. ')) %>%
#                   ungroup() %>%
#                   filter(first_date == 1),
#                 nudge_y=-500,
#                 aes(x=date, y=cumulative_downloads, color=label_w_group_id, label=group_id))+
annotate(geom = "rect", xmin = as.Date("2021-04-01"), xmax=as.Date("2021-04-30"), ymin=0, ymax=Inf, fill="red", alpha=0.2)+
annotate(geom="text", x= as.Date("2021-04-30"), y=17000, label="Economist Media Group", color="red")+
annotate(geom = "rect", xmin = as.Date("2021-06-01"), xmax=as.Date("2021-06-15"), ymin=0, ymax=Inf, fill="yellow", alpha=0.2)+
annotate(geom="text", x= as.Date("2021-06-01"), y=18000, label="Vox Media")+
scale_y_continuous(labels=scales::comma)+
scale_color_discrete()+
# scale_color_discrete(guide="none")+
scale_alpha_continuous(guide="none")+
ylab("Cumulative Downloads")+
xlab("Date")+
ggtitle("Daily Episode-Cumulative Downloads")+
theme_minimal()+
theme(
# legend.position='bottom',
# legend.position="none"
)
ggplot(chars_downloads_data %>%
mutate(daily_alpha = 1 + log(1/days_since_release)) %>%
arrange(release_date) %>%
group_by(release_date) %>%
mutate(first_date = ifelse(date == release_date, 1, 0),
group_id = cur_group_id(),
label_w_group_id = paste(group_id, episode_title, sep='. ')) %>%
view())+
geom_line(aes(x=date, y=cumulative_downloads, color=label_w_group_id, alpha=daily_alpha, group=episode_title), size=1.25)+
geom_label_repel(data = chars_downloads_data %>%
arrange(release_date) %>%
group_by(episode_title) %>%
mutate(first_date = ifelse(date == release_date+1, 1,0),
group_id = cur_group_id(),
label_w_group_id = paste(group_id, episode_title, sep='. ')) %>%
ungroup() %>%
filter(first_date == 1),
nudge_y=-500,
aes(x=date, y=cumulative_downloads, color=label_w_group_id, label=group_id))+
annotate(geom = "rect", xmin = as.Date("2021-04-01"), xmax=as.Date("2021-04-30"), ymin=0, ymax=Inf, fill="red", alpha=0.2)+
annotate(geom="text", x= as.Date("2021-04-30"), y=17000, label="Economist Media Group", color="red")+
annotate(geom = "rect", xmin = as.Date("2021-06-01"), xmax=as.Date("2021-06-15"), ymin=0, ymax=Inf, fill="yellow", alpha=0.2)+
annotate(geom="text", x= as.Date("2021-06-01"), y=18000, label="Vox Media")+
scale_y_continuous(labels=scales::comma)+
# scale_color_discrete()+
scale_color_discrete(guide="none")+
scale_alpha_continuous(guide="none")+
ylab("Cumulative Downloads")+
xlab("Date")+
ggtitle("Daily Episode-Cumulative Downloads")+
theme_minimal()+
theme(
# legend.position='bottom',
legend.position="none"
)
ggplot(chars_downloads_data %>%
mutate(daily_alpha = 1 + log(1/days_since_release)) %>%
arrange(release_date) %>%
group_by(release_date) %>%
mutate(first_date = ifelse(date == release_date, 1, 0),
group_id = cur_group_id(),
label_w_group_id = paste(group_id, episode_title, sep='. ')) %>%
view())+
geom_line(aes(x=date, y=cumulative_downloads, color=label_w_group_id, alpha=daily_alpha, group=episode_title), size=1.25)+
geom_label_repel(data = chars_downloads_data %>%
arrange(release_date) %>%
group_by(release_date) %>%
mutate(first_date = ifelse(date == release_date+1, 1,0),
group_id = cur_group_id(),
label_w_group_id = paste(group_id, episode_title, sep='. ')) %>%
ungroup() %>%
filter(first_date == 1),
nudge_y=-500,
aes(x=date, y=cumulative_downloads, color=label_w_group_id, label=group_id))+
annotate(geom = "rect", xmin = as.Date("2021-04-01"), xmax=as.Date("2021-04-30"), ymin=0, ymax=Inf, fill="red", alpha=0.2)+
annotate(geom="text", x= as.Date("2021-04-30"), y=17000, label="Economist Media Group", color="red")+
annotate(geom = "rect", xmin = as.Date("2021-06-01"), xmax=as.Date("2021-06-15"), ymin=0, ymax=Inf, fill="yellow", alpha=0.2)+
annotate(geom="text", x= as.Date("2021-06-01"), y=18000, label="Vox Media")+
scale_y_continuous(labels=scales::comma)+
# scale_color_discrete()+
scale_color_discrete(guide="none")+
scale_alpha_continuous(guide="none")+
ylab("Cumulative Downloads")+
xlab("Date")+
ggtitle("Daily Episode-Cumulative Downloads")+
theme_minimal()+
theme(
# legend.position='bottom',
legend.position="none"
)
